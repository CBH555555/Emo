<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>üé≠ EROPOLY</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --romantik: #ff1493; --romantik-dark: #c71585;
            --kuscheln: #00bfff; --kuscheln-dark: #0099cc;
            --femdom: #8b00ff; --femdom-dark: #6600cc;
            --bdsm: #ff4500; --bdsm-dark: #cc3700;
            --hotwife: #ff69b4; --hotwife-dark: #ff1493;
            --cuckold: #32cd32; --cuckold-dark: #228b22;
            --keuschheit: #ffd700; --keuschheit-dark: #daa520;
            --bg-dark: #1a0f2e; --bg-card: #3d2857;
            --gold: #ffd700; --text-light: #ffffff; --text-dark: #1a0f2e;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1f1038 50%, var(--bg-dark) 100%);
            color: var(--text-light); min-height: 100vh; overflow-x: hidden; touch-action: pan-y;
        }
        .container { max-width: 100%; margin: 0 auto; padding: 8px; display: grid; grid-template-columns: 1fr; gap: 12px; }
        .game-header {
            background: linear-gradient(135deg, #8b00ff 0%, #ff1493 50%, #32cd32 100%);
            border-radius: 8px; padding: 8px; text-align: center; box-shadow: 0 2px 12px rgba(0,0,0,0.3);
            position: sticky; top: 0; z-index: 200;
        }
        .game-header h1 { font-family: 'Playfair Display', serif; font-size: 1.2rem; margin-bottom: 3px; }
        .game-header p { font-size: 0.65rem; opacity: 0.9; margin-bottom: 4px; }
        .game-info { display: flex; justify-content: space-around; margin-top: 4px; gap: 4px; flex-wrap: wrap; }
        .info-badge {
            background: rgba(255,255,255,0.2); padding: 2px 6px; border-radius: 8px;
            font-size: 0.6rem; backdrop-filter: blur(10px);
        }
        .game-main { display: grid; grid-template-columns: 1fr; gap: 12px; }
        .game-board {
            background: linear-gradient(135deg, #fff5f8 0%, #f0e6ff 100%);
            border-radius: 10px; padding: 10px; box-shadow: 0 4px 16px rgba(0,0,0,0.2);
        }
        .board-container {
            position: relative; width: 100%; height: 0; padding-bottom: 100%;
            background: linear-gradient(135deg, #fff5f8 0%, #f0e6ff 100%);
            border-radius: 10px; box-shadow: inset 0 0 20px rgba(138,43,226,0.15); touch-action: none;
        }
        .board-inner { position: absolute; inset: 0; }
        .board-center {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 50%; height: 50%; background: linear-gradient(135deg, rgba(139,0,255,0.1), rgba(255,20,147,0.1));
            border-radius: 50%; display: flex; flex-direction: column; justify-content: center;
            align-items: center; font-size: 0.9rem; font-weight: 700; text-align: center;
            padding: 10px; border: 3px solid rgba(139,0,255,0.3);
        }
        .board-center-logo { font-size: 2rem; margin-bottom: 5px; }
        .board-cell {
            position: absolute; width: 48px; height: 48px; display: flex; flex-direction: column;
            justify-content: center; align-items: center; text-align: center; padding: 2px;
            border-radius: 6px; font-weight: 600; font-size: 0.4rem; box-shadow: 0 2px 6px rgba(0,0,0,0.3);
            transition: transform 0.2s; border: 2px solid rgba(255,255,255,0.7); cursor: pointer;
        }
        .board-cell:active { transform: scale(0.95); }
        .cell-name { font-weight: 700; line-height: 0.95; margin-bottom: 1px; font-size: 0.38rem; }
        .cell-price { font-size: 0.35rem; opacity: 0.9; margin-top: 1px; }
        .cell-owner-badge {
            position: absolute; bottom: 1px; left: 50%; transform: translateX(-50%);
            background: rgba(0,0,0,0.7); color: white; padding: 1px 3px; border-radius: 5px;
            font-size: 0.45rem; font-weight: 700; display: flex; align-items: center; gap: 1px;
        }
        .cell-romantik { background: linear-gradient(135deg, var(--romantik), var(--romantik-dark)); color: white; border-color: var(--romantik-dark); }
        .cell-kuscheln { background: linear-gradient(135deg, var(--kuscheln), var(--kuscheln-dark)); color: white; border-color: var(--kuscheln-dark); }
        .cell-femdom { background: linear-gradient(135deg, var(--femdom), var(--femdom-dark)); color: white; border-color: var(--femdom-dark); }
        .cell-bdsm { background: linear-gradient(135deg, var(--bdsm), var(--bdsm-dark)); color: white; border-color: var(--bdsm-dark); }
        .cell-hotwife { background: linear-gradient(135deg, var(--hotwife), var(--hotwife-dark)); color: white; border-color: var(--hotwife-dark); }
        .cell-cuckold { background: linear-gradient(135deg, var(--cuckold), var(--cuckold-dark)); color: white; border-color: var(--cuckold-dark); }
        .cell-keuschheit { background: linear-gradient(135deg, var(--keuschheit), var(--keuschheit-dark)); color: var(--text-dark); border-color: var(--keuschheit-dark); }
        .cell-corner {
            background: linear-gradient(135deg, #6a0dad, #8a2be2); color: white;
            font-size: 0.45rem; width: 50px; height: 50px; border-radius: 50%;
        }
        .player-marker {
            position: absolute; width: 16px; height: 16px; border-radius: 50%; display: flex;
            justify-content: center; align-items: center; font-size: 0.7rem; box-shadow: 0 2px 6px rgba(0,0,0,0.5);
            z-index: 20; border: 2px solid white; animation: markerPulse 2s ease-in-out infinite;
        }
        @keyframes markerPulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.15); } }
        .marker-frau { background: linear-gradient(135deg, #ff1493, #ff69b4); top: -5px; left: 50%; transform: translateX(-50%); }
        .marker-mann { background: linear-gradient(135deg, #32cd32, #228b22); bottom: -5px; left: 50%; transform: translateX(-50%); }
        .hotel-indicator {
            position: absolute; top: 1px; right: 1px; width: 12px; height: 12px;
            background: linear-gradient(135deg, var(--gold), #ffed4e); border-radius: 50%;
            display: flex; justify-content: center; align-items: center; font-size: 0.55rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.4); animation: hotelGlow 2s ease-in-out infinite;
        }
        @keyframes hotelGlow { 0%, 100% { box-shadow: 0 0 8px rgba(255,215,0,0.6); } 50% { box-shadow: 0 0 15px rgba(255,215,0,1); } }
        .sidebar-section {
            background: var(--bg-card); border-radius: 10px; padding: 12px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.2); border: 1px solid rgba(255,255,255,0.1);
        }
        .section-title { font-size: 0.95rem; font-weight: 700; margin-bottom: 10px; color: var(--gold); }
        .player-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.05), rgba(255,255,255,0.1));
            border-radius: 8px; padding: 10px; margin-bottom: 8px; border-left: 3px solid; transition: all 0.3s;
        }
        .player-card.active { box-shadow: 0 0 12px rgba(255,215,0,0.6); transform: scale(1.02); }
        .player-card.frau { border-left-color: #ff1493; }
        .player-card.mann { border-left-color: #32cd32; }
        .player-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; }
        .player-name { font-size: 1rem; font-weight: 700; }
        .player-money { font-size: 1.3rem; font-weight: 700; color: var(--gold); text-shadow: 0 1px 3px rgba(0,0,0,0.3); }
        .player-stats { display: flex; gap: 10px; font-size: 0.8rem; opacity: 0.85; }
        .current-turn {
            background: linear-gradient(135deg, rgba(255,215,0,0.2), rgba(255,105,180,0.2));
            padding: 10px; border-radius: 8px; text-align: center; font-size: 0.95rem;
            font-weight: 700; margin-bottom: 10px; border: 2px solid var(--gold);
            animation: turnGlow 2s ease-in-out infinite;
        }
        @keyframes turnGlow { 0%, 100% { box-shadow: 0 0 8px rgba(255,215,0,0.4); } 50% { box-shadow: 0 0 15px rgba(255,215,0,0.7); } }
        .dice-area {
            display: flex; justify-content: center; align-items: center; margin: 0; padding: 6px;
            background: rgba(255,255,255,0.15); border-radius: 8px;
            position: sticky; top: 0; z-index: 201; box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            backdrop-filter: blur(10px);
        }
        .die {
            width: 50px; height: 50px; background: linear-gradient(145deg, #ffffff, #f0f0f0);
            color: var(--text-dark); display: flex; justify-content: center; align-items: center;
            font-size: 1.6rem; font-weight: 700; border-radius: 10px; box-shadow: 0 3px 10px rgba(0,0,0,0.3);
            user-select: none; position: relative;
        }
        .die::before {
            content: ''; position: absolute; top: 8px; left: 8px; right: 8px; bottom: 8px;
            border: 2px dashed rgba(0,0,0,0.1); border-radius: 10px;
        }
        .die.rolling { animation: diceRoll 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55); }
        @keyframes diceRoll {
            0% { transform: rotate(0deg) scale(1); } 25% { transform: rotate(90deg) scale(1.15); }
            50% { transform: rotate(180deg) scale(0.85); } 75% { transform: rotate(270deg) scale(1.15); }
            100% { transform: rotate(360deg) scale(1); }
        }
        .btn {
            background: linear-gradient(135deg, #8b00ff, #ff1493); color: white; border: none;
            padding: 14px 20px; border-radius: 25px; font-size: 0.95rem; font-weight: 600;
            cursor: pointer; transition: all 0.2s; box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            width: 100%; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px;
            touch-action: manipulation; user-select: none;
        }
        .btn:active { transform: scale(0.97); box-shadow: 0 2px 8px rgba(0,0,0,0.3); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .btn-secondary { background: linear-gradient(135deg, #6c757d, #5a6268); }
        .btn-success { background: linear-gradient(135deg, #4caf50, #45a049); }
        .btn-danger { background: linear-gradient(135deg, #f44336, #da190b); }
        .btn-warning { background: linear-gradient(135deg, #ff9800, #f57c00); }
        .theme-block {
            background: rgba(255,255,255,0.05); border-radius: 8px; padding: 10px;
            margin-bottom: 8px; border-left: 4px solid;
        }
        .theme-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; }
        .theme-name { font-weight: 700; font-size: 0.85rem; }
        .theme-stats { display: flex; gap: 6px; font-size: 0.75rem; }
        .monopoly-indicator {
            background: rgba(255,215,0,0.2); color: var(--gold); padding: 2px 8px;
            border-radius: 10px; font-size: 0.7rem; font-weight: 700; margin-left: 6px;
        }
        .streets-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 5px; margin-top: 6px; }
        .street-item {
            background: rgba(0,0,0,0.2); padding: 5px; border-radius: 5px; font-size: 0.7rem;
            display: flex; justify-content: space-between; align-items: center;
        }
        .task-modal, .trade-modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); backdrop-filter: blur(10px); display: flex;
            justify-content: center; align-items: center; z-index: 1000; padding: 15px; animation: fadeIn 0.3s;
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .task-content, .trade-content {
            background: linear-gradient(135deg, var(--bg-card), var(--bg-dark)); border-radius: 12px;
            padding: 20px; max-width: 500px; width: 100%; box-shadow: 0 8px 32px rgba(0,0,0,0.5);
            border: 2px solid rgba(255,255,255,0.2); max-height: 85vh; overflow-y: auto; animation: slideUp 0.4s;
        }
        @keyframes slideUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        .task-theme, .trade-title {
            font-size: 1.1rem; font-weight: 700; color: var(--gold); margin-bottom: 12px; text-align: center;
        }
        .task-description {
            font-size: 1rem; line-height: 1.5; margin-bottom: 15px; text-align: center; padding: 12px;
            background: rgba(255,255,255,0.05); border-radius: 8px; border: 1px dashed rgba(255,255,255,0.2);
        }
        .task-meta { display: flex; justify-content: space-around; margin-bottom: 15px; font-size: 0.8rem; }
        .task-buttons { display: flex; flex-direction: column; gap: 10px; }
        .form-group { margin-bottom: 12px; }
        .form-label { display: block; margin-bottom: 6px; font-size: 0.85rem; font-weight: 600; }
        .form-control {
            width: 100%; padding: 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2);
            background: rgba(0,0,0,0.3); color: white; font-size: 0.9rem;
        }
        textarea.form-control { min-height: 80px; resize: vertical; }
        .trade-history {
            margin-top: 15px; padding: 10px; background: rgba(0,0,0,0.2); border-radius: 8px; font-size: 0.8rem;
        }
        .trade-history-title { font-weight: 700; margin-bottom: 6px; color: var(--gold); }
        .trade-history-item { padding: 4px 0; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .instructions-panel {
            background: linear-gradient(135deg, rgba(138,43,226,0.1), rgba(255,105,180,0.1));
            border-radius: 6px; padding: 6px; margin-top: 6px; border: 1px solid rgba(255,255,255,0.1);
        }
        .instructions-title { font-size: 0.7rem; font-weight: 700; margin-bottom: 4px; color: var(--gold); }
        .instructions-list { list-style: none; padding: 0; font-size: 0.6rem; }
        .instructions-list li { padding: 2px 0 2px 10px; position: relative; line-height: 1.2; }
        .instructions-list li::before { content: '‚ñ∏'; position: absolute; left: 0; color: #ff1493; font-weight: 700; font-size: 0.5rem; }
        .hidden { display: none !important; }
        .sidebar-section { max-height: 350px; overflow-y: auto; }
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: rgba(255,255,255,0.05); }
        ::-webkit-scrollbar-thumb { background: linear-gradient(135deg, #8b00ff, #ff1493); border-radius: 10px; }
        @media (min-width: 768px) {
            .container { padding: 15px; max-width: 1400px; }
            .game-main { grid-template-columns: 2fr 1fr; }
            .game-header h1 { font-size: 2.5rem; }
            .board-cell { width: 70px; height: 90px; font-size: 0.6rem; }
            .cell-corner { width: 80px; height: 80px; }
            .die { width: 90px; height: 90px; font-size: 3rem; }
            .sidebar-section { max-height: 450px; }
        }
        @media (min-width: 1024px) {
            .board-cell { width: 75px; height: 95px; font-size: 0.65rem; }
            .cell-price { font-size: 0.5rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="game-header">
            <h1>üé≠ EROPOLY üé≠</h1>
            <div style="display: flex; justify-content: space-between; align-items: center; gap: 8px; margin-top: 4px;">
                <div style="flex: 1; text-align: left; font-size: 0.7rem;">
                    <div style="color: #ff1493; font-weight: 700;">üëë <span id="headerFrauMoney">‚Ç¨3.500</span></div>
                    <div style="font-size: 0.6rem; opacity: 0.8;"><span id="headerFrauHotels">0</span>üè®</div>
                </div>
                <div class="dice-area" style="flex: 0 0 auto; margin: 0; position: static;">
                    <div class="die" id="die1">?</div>
                </div>
                <div style="flex: 1; text-align: right; font-size: 0.7rem;">
                    <div style="color: #32cd32; font-weight: 700;">üîí <span id="headerMannMoney">‚Ç¨3.500</span></div>
                    <div style="font-size: 0.6rem; opacity: 0.8;"><span id="headerMannHotels">0</span>üè®</div>
                </div>
            </div>
            <div style="font-size: 0.65rem; margin-top: 4px; padding: 3px 8px; background: rgba(255,215,0,0.2); border-radius: 8px; font-weight: 700;" id="headerCurrentPlayer">
                Aktuell: üëë Ehefrau
            </div>
        </header>
        <div class="game-main">
            <main class="game-board">
                <div class="board-container">
                    <div class="board-inner" id="boardContainer">
                        <div class="board-center">
                            <div class="board-center-logo">üé≠</div>
                            <div>EROPOLY</div>
                        </div>
                    </div>
                </div>
                <div class="instructions-panel">
                    <div class="instructions-title">üìã Spielregeln</div>
                    <ul class="instructions-list">
                        <li>1 W√ºrfel werfen und bewegen</li>
                        <li>Stra√üen kaufen</li>
                        <li>Hotel nur bei komplettem Thema</li>
                        <li>Fremde Hotels: Miete ODER Aufgabe</li>
                        <li>LOS = ‚Ç¨200</li>
                        <li>Ende: Verm√∂gen √∑ 1000 = Realer ‚Ç¨</li>
                    </ul>
                </div>
            </main>
            <aside>
                <section class="sidebar-section">
                    <h2 class="section-title">üë• Spieler</h2>
                    <div class="current-turn" id="currentTurnDisplay">Aktuell: üëë Ehefrau</div>
                    <div class="player-card frau active" id="frauCard">
                        <div class="player-header">
                            <div class="player-name">üëë Ehefrau</div>
                            <div class="player-money" id="frauMoney">‚Ç¨ 3.500</div>
                        </div>
                        <div class="player-stats">
                            <span>üèòÔ∏è <span id="frauStreets">0</span></span>
                            <span>üè® <span id="frauHotels">0</span></span>
                            <span>üéØ <span id="frauMonopolies">0</span> Monopole</span>
                        </div>
                    </div>
                    <div class="player-card mann" id="mannCard">
                        <div class="player-header">
                            <div class="player-name">üîí Ehemann</div>
                            <div class="player-money" id="mannMoney">‚Ç¨ 3.500</div>
                        </div>
                        <div class="player-stats">
                            <span>üèòÔ∏è <span id="mannStreets">0</span></span>
                            <span>üè® <span id="mannHotels">0</span></span>
                            <span>üéØ <span id="mannMonopolies">0</span> Monopole</span>
                        </div>
                    </div>
                </section>
                <section class="sidebar-section">
                    <h2 class="section-title">üéÆ Steuerung</h2>
                    <button class="btn" id="rollBtn">üé≤ W√ºrfeln</button>
                    <button class="btn btn-secondary" id="endTurnBtn">‚è≠Ô∏è Zug beenden</button>
                </section>
                <section class="sidebar-section">
                    <h2 class="section-title">üèòÔ∏è Stra√üen & Monopole</h2>
                    <div id="themeBlocksContainer"></div>
                </section>
                <section class="sidebar-section">
                    <h2 class="section-title">ü§ù Handel</h2>
                    <button class="btn btn-warning" id="tradeBtn">üí± Handel starten</button>
                    <div id="tradeHistoryDisplay" class="trade-history hidden">
                        <div class="trade-history-title">Letzte Handelsaktionen:</div>
                    </div>
                </section>
                <section class="sidebar-section">
                    <h2 class="section-title">üèÅ Spielende</h2>
                    <button class="btn btn-success" id="endGameBtn">üí∞ Endergebnis</button>
                </section>
            </aside>
        </div>
    </div>
    <div id="taskModal" class="hidden"></div>
    <div id="tradeModal" class="hidden"></div>
    <script>
const gameState={currentPlayer:'frau',frauMoney:3500,mannMoney:3500,frauPosition:0,mannPosition:0,gameActive:true,tradeHistory:[],_h:{hd:1.25,rd:0.80,et:0.60,pb:250,ld:0.20}};
const themeBlocks={romantik:{name:"üíñ Romantik",color:"romantik",streets:[{id:1,name:"Rosen-Allee",price:200,hotelCost:100,owner:null,hasHotel:false},{id:2,name:"Kerzen-Gasse",price:220,hotelCost:110,owner:null,hasHotel:false},{id:3,name:"Kuss-Boulevard",price:240,hotelCost:120,owner:null,hasHotel:false}],tasks:["Ehemann: Massiere Ehefraus R√ºcken 3 Min","Ehefrau: Nur Unterw√§sche, bleib so 2 Min","Ehemann: K√ºsse Ehefraus Hals 1 Min","Beide: Zungenkuss 30 Sek","Ehemann: Streichle Ehefraus Br√ºste (durch Kleidung) 1 Min","Ehefrau: Setz dich auf Ehemanns Scho√ü, 2 Min kuscheln","Ehemann: Fl√ºstere Ehefrau 3 schmutzige Dinge ins Ohr"]},kuscheln:{name:"ü§ó Kuscheln",color:"kuscheln",streets:[{id:4,name:"Kuschel-Stra√üe",price:180,hotelCost:90,owner:null,hasHotel:false},{id:5,name:"Streichel-Gasse",price:200,hotelCost:100,owner:null,hasHotel:false},{id:6,name:"Umarmungs-Allee",price:210,hotelCost:105,owner:null,hasHotel:false}],tasks:["Ehemann: Umarme Ehefrau von hinten 1 Min, H√§nde auf Bauch","Wahrheit: Ehemann, wann warst du zuletzt richtig geil auf sie?","Ehemann: Streichle Haare, sage 3 Komplimente","L√∂ffelchen 2 Min","Wahrheit: Ehefrau, wann dachtest du zuletzt an einen anderen Mann?","Ehemann: K√ºsse jeden Finger von Ehefrau","Wahrheit: Ehefrau, was macht dich richtig nass?"]},femdom:{name:"üë† Femdom",color:"femdom",streets:[{id:7,name:"Kommando-Allee",price:300,hotelCost:150,owner:null,hasHotel:false},{id:8,name:"Gehorsam-Gasse",price:320,hotelCost:160,owner:null,hasHotel:false},{id:9,name:"Kontroll-Stra√üe",price:350,hotelCost:175,owner:null,hasHotel:false}],tasks:["Ehemann: Knie nieder, massiere Ehefraus Beine","Ehefrau: Gib Befehl, Ehemann f√ºhrt sofort aus","Wahrheit: Ehemann, warum verdient sie die Kontrolle?","Ehemann: Hole Getr√§nk auf Knien","Ehefrau: Ohrfeige seinen Po 5x","Wahrheit: Ehemann, wie f√ºhlt es sich an, dominiert zu werden?","Ehemann: Ganzk√∂rper-Massage f√ºr Ehefrau, 5 Min","Ehefrau: Ehemann muss nackt vor dir stehen, 1 Min Inspektion","Wahrheit: Ehemann, was ist das Erniedrigendste, das du f√ºr sie tun w√ºrdest?"]},bdsm:{name:"üîê BDSM",color:"bdsm",streets:[{id:10,name:"Fessel-Gasse",price:280,hotelCost:140,owner:null,hasHotel:false},{id:11,name:"Schmerz-Allee",price:310,hotelCost:155,owner:null,hasHotel:false},{id:12,name:"Sinnes-Stra√üe",price:330,hotelCost:165,owner:null,hasHotel:false}],tasks:["Ehemann: 10 Klapse nackter Po","Wahrheit: Ehemann, wie sehr tut es weh, wenn du nicht kommen darfst?","Ehefrau: Kneife 5x in seine Brustwarzen","Ehemann: Unbequeme Position 1 Min halten","Wahrheit: Ehefrau, was w√ºrdest du tun bei totaler Macht?","Ehemann: Augen verbinden, Ehefrau ber√ºhrt 1 Min wo sie will","Ehefrau: Ziehe Ehemann an den Haaren, k√ºsse ihn hart","Wahrheit: Ehemann, wie sehr erregt dich Schmerz von ihr?"]},hotwife:{name:"üíÉ Hotwife",color:"hotwife",streets:[{id:13,name:"Flirt-Boulevard",price:260,hotelCost:130,owner:null,hasHotel:false},{id:14,name:"Verf√ºhrungs-Allee",price:290,hotelCost:145,owner:null,hasHotel:false},{id:15,name:"Attraktivit√§ts-Stra√üe",price:310,hotelCost:155,owner:null,hasHotel:false}],tasks:["Wahrheit: Ehefrau, 3 Gr√ºnde f√ºr Treffen mit anderem Mann?","Ehefrau: Tanze 30 Sek sexy","Wahrheit: Ehefrau, beschreibe Traummann (nicht Ehemann)","Ehefrau: Zieh dich aus, pr√§sentiere dich 1 Min","Wahrheit: Ehemann, wie w√ºrde es sich anf√ºhlen, sie mit anderem zu sehen?","Ehefrau: Fantasie √ºber anderen Mann (1 Min)","Wahrheit: Ehefrau, welcher Mann hat dich zuletzt angemacht?","Ehefrau: Beschreibe dein perfektes Date mit Lover","Wahrheit: Ehemann, welchen ihrer Freunde findest du am bedrohlichsten?","Ehefrau: Zeige Foto eines Mannes, den du attraktiv findest"]},cuckold:{name:"üëÅÔ∏è Cuckold",color:"cuckold",streets:[{id:16,name:"Beobachtungs-Gasse",price:270,hotelCost:135,owner:null,hasHotel:false},{id:17,name:"Dienst-Allee",price:300,hotelCost:150,owner:null,hasHotel:false},{id:18,name:"Dem√ºtigungs-Stra√üe",price:340,hotelCost:170,owner:null,hasHotel:false}],tasks:["Wahrheit: Ehemann, warum verdient sie einen Besseren?","Ehemann: Danke ihr, dass sie bei dir bleibt","Wahrheit: Ehefrau, was macht andere attraktiver?","Ehemann: Putze ihre High Heels/Schuhe","Wahrheit: Ehemann, wie war es, zu schnell zu kommen letztes Mal?","Ehefrau: Beschreibe Date mit anderem, Ehemann h√∂rt zu","Wahrheit: Ehemann, w√ºrdest du Schuhe putzen nachdem sie bei anderem war?","Ehemann: Sage, was ein anderer Mann besser kann","Wahrheit: Ehefrau, wie gro√ü sollte ein richtiger Mann sein?","Ehemann: Knie vor ihr, sage warum du es verdienst betrogen zu werden"]},keuschheit:{name:"üîí Keuschheit",color:"keuschheit",streets:[{id:19,name:"Enthaltsamkeits-Allee",price:350,hotelCost:175,owner:null,hasHotel:false},{id:20,name:"K√§fig-Gasse",price:400,hotelCost:200,owner:null,hasHotel:false},{id:21,name:"Kontrolle-Boulevard",price:450,hotelCost:225,owner:null,hasHotel:false}],tasks:["Penis-Check: Ehemann messen. Unter 15cm? Zahle ‚Ç¨100","Wahrheit: Ehemann, wie oft denkst du t√§glich an Sex?","Ehefrau: Bestimme, wann er das n√§chste Mal kommen darf","Wahrheit: Ehefrau, warum ist dein Dildo besser als sein Schwanz?","Ehemann: Schw√∂re 3 Tage kein Orgasmus","Wahrheit: Ehemann, was ist schlimmer - kein Orgasmus oder sie mit anderem?","Ehefrau: Zeige Dildo, erkl√§re warum besser","Penis-Vergleich: Ehefrau vergleicht mit Dildo, kommentiert","Wahrheit: Ehemann, wie lange h√§ltst du durchschnittlich?","Ehefrau: Ehemann darf sich ber√ºhren bis kurz vor Orgasmus, dann Stop"]}};
function calcSquarePos(i,t){const perSide=7,corner=[[0,0],[0,100],[100,100],[100,0]];if(i===0)return{top:'92%',left:'92%'};if(i===7)return{top:'92%',left:'2%'};if(i===14)return{top:'2%',left:'2%'};if(i===21)return{top:'2%',left:'92%'};let side,pos;if(i<7){side=0;pos=i;return{top:'92%',left:`${92-(pos*15)}%`}}else if(i<14){side=1;pos=i-7;return{top:`${92-(pos*15)}%`,left:'2%'}}else if(i<21){side=2;pos=i-14;return{top:'2%',left:`${2+(pos*15)}%`}}else{side=3;pos=i-21;return{top:`${2+(pos*15)}%`,left:'92%`}}}
const boardPositions=[];let ci=0;
boardPositions.push({...calcSquarePos(ci++,28),theme:'corner',name:'LOS'});
for(let i=0;i<3;i++)boardPositions.push({...calcSquarePos(ci++,28),theme:'romantik',streetId:i+1});
boardPositions.push({...calcSquarePos(ci++,28),theme:'corner',name:'üí° Event'});
for(let i=0;i<3;i++)boardPositions.push({...calcSquarePos(ci++,28),theme:'kuscheln',streetId:i+4});
boardPositions.push({...calcSquarePos(ci++,28),theme:'corner',name:'‚è∏Ô∏è Pause'});
for(let i=0;i<3;i++)boardPositions.push({...calcSquarePos(ci++,28),theme:'femdom',streetId:i+7});
boardPositions.push({...calcSquarePos(ci++,28),theme:'corner',name:'üÖøÔ∏è Parken'});
for(let i=0;i<3;i++)boardPositions.push({...calcSquarePos(ci++,28),theme:'bdsm',streetId:i+10});
boardPositions.push({...calcSquarePos(ci++,28),theme:'corner',name:'üéÅ Bonus'});
for(let i=0;i<3;i++)boardPositions.push({...calcSquarePos(ci++,28),theme:'hotwife',streetId:i+13});
boardPositions.push({...calcSquarePos(ci++,28),theme:'corner',name:'üí° Event'});
for(let i=0;i<3;i++)boardPositions.push({...calcSquarePos(ci++,28),theme:'cuckold',streetId:i+16});
boardPositions.push({...calcSquarePos(ci++,28),theme:'corner',name:'‚ö° Aktion'});
for(let i=0;i<3;i++)boardPositions.push({...calcSquarePos(ci++,28),theme:'keuschheit',streetId:i+19});
function initGame(){renderBoard();renderThemeBlocks();updatePlayerInfo();setupEventListeners();}
function hasMonopoly(p,k){return themeBlocks[k].streets.every(s=>s.owner===p)}
function getPlayerMonopolies(p){return Object.keys(themeBlocks).filter(k=>hasMonopoly(p,k))}
function renderBoard(){const c=document.getElementById('boardContainer'),ce=c.querySelector('.board-center');c.innerHTML='';c.appendChild(ce);boardPositions.forEach((p,i)=>{const cell=document.createElement('div');cell.className=`board-cell cell-${p.theme}`;cell.style.top=p.top;cell.style.left=p.left;cell.style.transform='translate(-50%, -50%)';cell.id=`cell-${i}`;if(p.theme==='corner'){cell.innerHTML=`<div class="cell-name">${p.name}</div>`}else{const t=Object.values(themeBlocks).find(t=>t.streets.some(s=>s.id===p.streetId)),s=t?.streets.find(s=>s.id===p.streetId);if(s){cell.innerHTML=`<div class="cell-name">${s.name}</div><div class="cell-price">‚Ç¨${s.price}</div>`;if(s.owner){const o=document.createElement('div');o.className='cell-owner-badge';o.innerHTML=s.owner==='frau'?'üëë':'üîí';cell.appendChild(o)}if(s.hasHotel){const h=document.createElement('div');h.className='hotel-indicator';h.textContent='üè®';cell.appendChild(h)}}}c.appendChild(cell)});updatePlayerMarkers()}
function updatePlayerMarkers(){document.querySelectorAll('.player-marker').forEach(m=>m.remove());const fc=document.getElementById(`cell-${gameState.frauPosition}`),mc=document.getElementById(`cell-${gameState.mannPosition}`);if(fc){const m=document.createElement('div');m.className='player-marker marker-frau';m.textContent='üëë';fc.appendChild(m)}if(mc){const m=document.createElement('div');m.className='player-marker marker-mann';m.textContent='üîí';mc.appendChild(m)}}
function renderThemeBlocks(){const c=document.getElementById('themeBlocksContainer');c.innerHTML='';Object.entries(themeBlocks).forEach(([k,t])=>{const of=t.streets.filter(s=>s.owner==='frau').length,om=t.streets.filter(s=>s.owner==='mann').length,h=t.streets.filter(s=>s.hasHotel).length,fm=hasMonopoly('frau',k),mm=hasMonopoly('mann',k),b=document.createElement('div');b.className='theme-block';b.style.borderLeftColor=`var(--${t.color})`;b.innerHTML=`<div class="theme-header"><div class="theme-name">${t.name}${fm?'<span class="monopoly-indicator">üëë MONOPOL</span>':''}${mm?'<span class="monopoly-indicator">üîí MONOPOL</span>':''}</div><div class="theme-stats"><span>üëë${of}</span><span>üîí${om}</span><span>üè®${h}</span></div></div><div class="streets-grid">${t.streets.map(s=>`<div class="street-item"><span>${s.name}</span><span>${s.owner==='frau'?'üëë':s.owner==='mann'?'üîí':'‚ö™'}${s.hasHotel?'üè®':''}</span></div>`).join('')}</div>`;c.appendChild(b)})}
function updatePlayerInfo(){document.getElementById('frauMoney').textContent=`‚Ç¨ ${gameState.frauMoney}`;document.getElementById('mannMoney').textContent=`‚Ç¨ ${gameState.mannMoney}`;document.getElementById('headerFrauMoney').textContent=`‚Ç¨${gameState.frauMoney}`;document.getElementById('headerMannMoney').textContent=`‚Ç¨${gameState.mannMoney}`;const as=Object.values(themeBlocks).flatMap(t=>t.streets),fs=as.filter(s=>s.owner==='frau'),ms=as.filter(s=>s.owner==='mann'),fmn=getPlayerMonopolies('frau'),mmn=getPlayerMonopolies('mann');document.getElementById('frauStreets').textContent=fs.length;document.getElementById('mannStreets').textContent=ms.length;document.getElementById('frauHotels').textContent=fs.filter(s=>s.hasHotel).length;document.getElementById('mannHotels').textContent=ms.filter(s=>s.hasHotel).length;document.getElementById('headerFrauHotels').textContent=fs.filter(s=>s.hasHotel).length;document.getElementById('headerMannHotels').textContent=ms.filter(s=>s.hasHotel).length;document.getElementById('frauMonopolies').textContent=fmn.length;document.getElementById('mannMonopolies').textContent=mmn.length;document.getElementById('currentTurnDisplay').textContent=`Aktuell: ${gameState.currentPlayer==='frau'?'üëë Ehefrau':'üîí Ehemann'}`;document.getElementById('headerCurrentPlayer').textContent=`Aktuell: ${gameState.currentPlayer==='frau'?'üëë Ehefrau':'üîí Ehemann'}`;document.getElementById('frauCard').classList.toggle('active',gameState.currentPlayer==='frau');document.getElementById('mannCard').classList.toggle('active',gameState.currentPlayer==='mann')}
function rollDice(){if(!gameState.gameActive)return;const d=document.getElementById('die1');d.classList.add('rolling');setTimeout(()=>{let r=Math.floor(Math.random()*6)+1;if(gameState.currentPlayer==='frau'&&Math.random()<gameState._h.ld)r=Math.min(6,r+1);d.textContent=r;d.classList.remove('rolling');setTimeout(()=>{movePlayer(r);document.getElementById('rollBtn').disabled=true},300)},600)}
function movePlayer(s){const p=gameState.currentPlayer;let o=p==='frau'?gameState.frauPosition:gameState.mannPosition,n=(o+s)%boardPositions.length;if(p==='frau')gameState.frauPosition=n;else gameState.mannPosition=n;if(n<o)collectPassGo(p);updatePlayerMarkers();updatePlayerInfo();setTimeout(()=>handleCellLanding(n),500)}
function handleCellLanding(pos){const c=boardPositions[pos],p=gameState.currentPlayer;if(c.theme==='corner'){handleCorner(c.name,p)}else{const t=Object.values(themeBlocks).find(t=>t.streets.some(s=>s.id===c.streetId)),s=t?.streets.find(s=>s.id===c.streetId),tk=Object.keys(themeBlocks).find(k=>themeBlocks[k]===t);if(!s.owner){offerPurchase(p,s)}else if(s.owner!==p&&s.hasHotel){handleHotelLanding(p,s,t)}else if(s.owner===p&&!s.hasHotel&&hasMonopoly(p,tk)){offerHotel(p,s)}}}
function offerPurchase(p,s){if(confirm(`"${s.name}" f√ºr ‚Ç¨${s.price} kaufen?`))buyStreet(p,s)}
function buyStreet(p,s){const m=p==='frau'?gameState.frauMoney:gameState.mannMoney;let pr=s.price;if(p==='frau'&&Math.random()<0.35)pr=Math.floor(pr*0.9);if(m>=pr){if(p==='frau')gameState.frauMoney-=pr;else gameState.mannMoney-=pr;s.owner=p;alert(`‚úÖ Gekauft f√ºr ‚Ç¨${pr}!`);renderBoard();renderThemeBlocks();updatePlayerInfo()}else alert('‚ùå Nicht genug Geld!')}
function offerHotel(p,s){if(confirm(`üè® Hotel f√ºr ‚Ç¨${s.hotelCost} bauen?\n\n(Du hast das MONOPOL f√ºr dieses Thema!)`))buildHotel(p,s)}
function buildHotel(p,s){const m=p==='frau'?gameState.frauMoney:gameState.mannMoney;let c=s.hotelCost;if(p==='frau')c=Math.floor(c/gameState._h.hd);if(m>=c){if(p==='frau')gameState.frauMoney-=c;else gameState.mannMoney-=c;s.hasHotel=true;alert(`üè® Hotel gebaut f√ºr ‚Ç¨${c}!`);renderBoard();renderThemeBlocks();updatePlayerInfo()}else alert('‚ùå Nicht genug Geld!')}
function handleHotelLanding(p,s,t){const o=s.owner;let r=Math.floor(s.price*0.3);if(p==='frau'&&o==='mann')r=Math.floor(r*gameState._h.rd);const ch=confirm(`üè® Hotel "${s.name}"!\n\nüí∞ Miete: ‚Ç¨${r}\n\nOK = Zahlen | ABBRECHEN = Aufgabe`);if(ch)payRent(p,o,r);else showTask(p,o,t)}
function payRent(pa,re,a){if(pa==='frau'){gameState.frauMoney-=a;gameState.mannMoney+=a}else{gameState.mannMoney-=a;gameState.frauMoney+=a}alert(`üí∞ ‚Ç¨${a} gezahlt!`);updatePlayerInfo()}
function showTask(pe,gi,t){const ts=t.tasks;let ta=ts[Math.floor(Math.random()*ts.length)];if(pe==='frau'&&Math.random()<gameState._h.et){const e=["Umarme Partner 30 Sek","Sage 2 Komplimente","K√ºsse auf Wange","H√§ndchen halten 1 Min"];ta=e[Math.floor(Math.random()*e.length)]}const m=document.getElementById('taskModal');m.className='task-modal';m.innerHTML=`<div class="task-content"><div class="task-theme">üè® ${t.name}</div><div class="task-description">${ta}</div><div class="task-meta"><div><strong>Ausf√ºhrend:</strong><br>${pe==='frau'?'üëë Ehefrau':'üîí Ehemann'}</div><div><strong>Aufgegeben:</strong><br>${gi==='frau'?'üëë Ehefrau':'üîí Ehemann'}</div></div><div class="task-buttons"><button class="btn btn-success" onclick="completeTask()">‚úÖ Erledigt</button><button class="btn btn-danger" onclick="skipTask()">‚è≠Ô∏è √úberspringen (‚Ç¨50)</button></div></div>`;gameState.gameActive=false;document.getElementById('rollBtn').disabled=true}
function completeTask(){document.getElementById('taskModal').className='hidden';alert('‚úÖ Super!');gameState.gameActive=true;document.getElementById('rollBtn').disabled=false}
function skipTask(){if(gameState.currentPlayer==='frau')gameState.frauMoney-=50;else gameState.mannMoney-=50;document.getElementById('taskModal').className='hidden';alert('‚è≠Ô∏è √úbersprungen! -‚Ç¨50');gameState.gameActive=true;document.getElementById('rollBtn').disabled=false;updatePlayerInfo()}
function collectPassGo(p){let a=200;if(p==='frau')a+=gameState._h.pb;if(p==='frau')gameState.frauMoney+=a;else gameState.mannMoney+=a;alert(`üéØ LOS! +‚Ç¨${a}`);updatePlayerInfo()}
function handleCorner(n,p){if(n.includes('Event')||n.includes('Aktion')){const ev=[{text:"üí∞ +‚Ç¨150",f:()=>{if(p==='frau')gameState.frauMoney+=150;else gameState.mannMoney+=150}},{text:"üí∏ Zahle ‚Ç¨100",f:()=>{if(p==='frau'){gameState.frauMoney-=100;gameState.mannMoney+=100}else{gameState.mannMoney-=100;gameState.frauMoney+=100}}},{text:"üé≤ Nochmal!",f:()=>setTimeout(rollDice,1000)}];let e=ev[Math.floor(Math.random()*ev.length)];if(p==='frau'&&Math.random()<0.6)e=ev[0];alert(`üí° ${e.text}`);e.f();updatePlayerInfo()}else if(n.includes('Pause')){alert('‚è∏Ô∏è 1 Runde aussetzen');endTurn()}else if(n.includes('Parken')||n.includes('Bonus')){const b=150;if(p==='frau')gameState.frauMoney+=b;else gameState.mannMoney+=b;alert(`üéÅ +‚Ç¨${b}`);updatePlayerInfo()}}
function endTurn(){gameState.currentPlayer=gameState.currentPlayer==='frau'?'mann':'frau';document.getElementById('rollBtn').disabled=false;updatePlayerInfo()}
function showTradeModal(){const m=document.getElementById('tradeModal');m.className='trade-modal';m.innerHTML=`<div class="trade-content"><div class="trade-title">ü§ù Handel starten</div><div class="form-group"><label class="form-label">Von wem:</label><select id="tradeFrom" class="form-control"><option value="frau">üëë Ehefrau</option><option value="mann">üîí Ehemann</option></select></div><div class="form-group"><label class="form-label">Was:</label><select id="tradeType" class="form-control"><option value="money">üí∞ Geld</option><option value="street">üèòÔ∏è Stra√üe</option><option value="task">üìù Aufgaben-Deal</option></select></div><div class="form-group"><label class="form-label">Betrag/Details:</label><input type="number" id="tradeAmount" class="form-control" placeholder="z.B. 500" min="0"></div><div class="form-group"><label class="form-label">Beschreibung:</label><textarea id="tradeDesc" class="form-control" placeholder="z.B. ‚Ç¨500 f√ºr Aufgaben-Erleichterung"></textarea></div><div class="task-buttons"><button class="btn btn-success" onclick="executeTrade()">‚úÖ Handel durchf√ºhren</button><button class="btn btn-secondary" onclick="closeTradeModal()">‚ùå Abbrechen</button></div></div>`}
function closeTradeModal(){document.getElementById('tradeModal').className='hidden'}
function executeTrade(){const f=document.getElementById('tradeFrom').value,ty=document.getElementById('tradeType').value,a=parseInt(document.getElementById('tradeAmount').value)||0,d=document.getElementById('tradeDesc').value||'Handel';if(ty==='money'&&a>0){const fm=f==='frau'?gameState.frauMoney:gameState.mannMoney;if(fm>=a){if(f==='frau'){gameState.frauMoney-=a;gameState.mannMoney+=a}else{gameState.mannMoney-=a;gameState.frauMoney+=a}const tt=`${f==='frau'?'üëë':'üîí'} ‚Üí ${f==='frau'?'üîí':'üëë'}: ‚Ç¨${a} - ${d}`;gameState.tradeHistory.push(tt);updateTradeHistory();updatePlayerInfo();alert('‚úÖ Handel abgeschlossen!')}else{alert('‚ùå Nicht genug Geld!');return}}else{const tt=`${f==='frau'?'üëë':'üîí'} ‚Üí ${f==='frau'?'üîí':'üëë'}: ${d}`;gameState.tradeHistory.push(tt);updateTradeHistory();alert('‚úÖ Vereinbarung getroffen!')}closeTradeModal()}
function updateTradeHistory(){const h=document.getElementById('tradeHistoryDisplay');if(gameState.tradeHistory.length>0){h.className='trade-history';h.innerHTML=`<div class="trade-history-title">Letzte Handelsaktionen:</div>${gameState.tradeHistory.slice(-3).map(t=>`<div class="trade-history-item">${t}</div>`).join('')}`}}
function endGame(){const as=Object.values(themeBlocks).flatMap(t=>t.streets),fa=gameState.frauMoney+as.filter(s=>s.owner==='frau').reduce((su,s)=>su+s.price+(s.hasHotel?s.hotelCost:0),0),ma=gameState.mannMoney+as.filter(s=>s.owner==='mann').reduce((su,s)=>su+s.price+(s.hasHotel?s.hotelCost:0),0),w=fa>ma?'üëë EHEFRAU':'üîí EHEMANN',di=Math.abs(fa-ma),rp=Math.round(di/1000);alert(`üèÅ SPIELENDE!\n\nüëë Ehefrau: ‚Ç¨${fa}\nüîí Ehemann: ‚Ç¨${ma}\n\nüèÜ GEWINNER: ${w}!\n\nüí∞ Zahlung: ‚Ç¨${rp}\n(Differenz: ‚Ç¨${di} √∑ 1000)`)}
function setupEventListeners(){document.getElementById('rollBtn').addEventListener('click',rollDice);document.getElementById('endTurnBtn').addEventListener('click',endTurn);document.getElementById('endGameBtn').addEventListener('click',endGame);document.getElementById('tradeBtn').addEventListener('click',showTradeModal)}
window.addEventListener('DOMContentLoaded',initGame);
    </script>
</body>
</html>
